<html>
	<script src = "./static/js/Chart.js"></script>
        <!-- 新 Bootstrap 核心 CSS 文件 -->
   <link rel = "stylesheet" href = "./static/css/flat-ui.css">
      <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="./static/js/flat-ui.min.js"></script>
    <script src="./static/js/application.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
  <head>
    <title>知乎点赞用户分析</title>
  </head>
  <body>
    <div id = "search" style="width:50%;height:auto;border:0px solid #000000;margin:0 auto;align:center">        
         <!-- <div class="form-search"> -->
          <!--<form>-->
             <input type="text" class="form-control input-hg" placeholder="知乎问题链接" style = "width:80%" id="url"/>          
             <button class="btn btn-hg btn-primary" id="submitBtn" onClick = "getUrl()"  style = "cursor:pointer">Search</button>
         <!--</form> --> 
        </div>
   </div>   
   <div id = "chart" style = "width:90%;height:auto;border:1px solid #000000;margin:0 auto">
      <div id = "like" style="width: 25%;float:left">      
          <div>
              <canvas id="like_Chart" width="400" height="450"></canvas>
      	  </div>
          <div style = "text-align:center;font-weight:bold;font-size:13">点赞用户获取的like分布图</div>
       </div>

       <div id = "thank" style="width:25%;float:left">      
          <div >
              <canvas id="thank_Chart" width="400" height="450"></canvas>
          </div>
          <div style = "text-align:center;font-weight:bold;font-size:13">点赞用户获取的thank分布图</div>
       </div>

       <div id = "question" style="width:25%;float:left">      
          <div >
              <canvas id="question_Chart" width="400" height="450"></canvas>
          </div>
           <div style = "text-align:center;font-weight:bold;font-size:13">点赞用户提出的question分布图</div>
       </div>

       <div id = "answer" style="width:25%;float:left">      
          <div >
              <canvas id="answer_Chart" width="400" height="450"></canvas>
          </div>
           <div style = "text-align:center;font-weight:bold;font-size:13">点赞用户回答的answer分布图</div>
       </div>
    </div>
  </body>
  
<script type = "text/javaScript">
window.onload = function()
{
  $('#like').hide();
  $('#thank').hide();
  $('#answer').hide();
  $('#question').hide();
}
function getUrl()
{
   
    //获取链接
     url = $('#url').val();
      console.log(url);
    // posturl = "/url/"+url;
    postdata(url);
}

function postdata(url)
{
    $.ajax({
        type:"POST",
        url:"/url",
        data:{"url":url},
        dataType:"json",
        success:function(data)
        {
            console.log(data);
            //alert("success");
            showPie(data);
        }
    });
}

function showPie(data)
{
		result = eval(data);
    $('#like').show();
    $('#thank').show();
    $('#question').show();
    $('#answer').show();
		var likeChartData = {
      labels : result['like_value'],
      datasets : [
        {
          fillColor : "rgba(220,220,220,0.5)",
          strokeColor : "rgba(220,220,220,1)",
          data : result['like_num']
        },
      ]
      
    }

    var thankChartData = {
      labels : result['thank_value'],
      datasets : [
        {
          fillColor : "rgba(220,220,220,0.5)",
          strokeColor : "rgba(220,220,220,1)",
          data : result['thank_num']
        },
      ]
      
    }

    var questionChartData = {
      labels : result['question_value'],
      datasets : [
        {
          fillColor : "rgba(220,220,220,0.5)",
          strokeColor : "rgba(220,220,220,1)",
          data : result['question_num']
        },
      ]
      
    }

    var answerChartData = {
      labels : result['answer_value'],
      datasets : [
        {
          fillColor : "rgba(220,220,220,0.5)",
          strokeColor : "rgba(220,220,220,1)",
          data : result['answer_num']
        },
      ]
      
    }

  var likeLine = new Chart(document.getElementById("like_Chart").getContext("2d")).Bar(likeChartData);

  var thankLine = new Chart(document.getElementById("thank_Chart").getContext("2d")).Bar(thankChartData);

  var questionLine = new Chart(document.getElementById("question_Chart").getContext("2d")).Bar(questionChartData);

  var answerLine = new Chart(document.getElementById("answer_Chart").getContext("2d")).Bar(answerChartData);
	
	
}
</script>
</html>